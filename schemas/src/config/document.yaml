# yaml-language-server: $schema=https://json-schema.org/draft/2020-12/schema
$schema:     https://json-schema.org/draft/2020-12/schema
$id:         <HOST>/<PREFIX>/<VERSION>/config/document.yaml
title:       DSC configuration document schema
description: Describes a valid DSC configuration document.

markdownDescription: | # VS Code only
  ***
  [_Online Documentation_][01]
  ***

  Describes a valid DSC configuration document.

  DSC configurations enable users to define state by combining different DSC resources. A
  configuration document uses parameters and variables to pass to a set of one or more resources
  that define a desired state.

  [01]: <DOCS_BASE_URL>/reference/schemas/config/document?<DOCS_VERSION_PIN>


type: object
required:
  - $schema
  - resources
properties:
  $schema:
    title: Schema
    description: >-
      Indicates the URI that resolves to the version of this schema that the document adheres to.
      DSC uses this property when validating and processing the configuration document.
    type: string
    format: uri
    enum:
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3/config/document.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3/bundled/config/document.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3/bundled/config/document.vscode.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0/config/document.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0/bundled/config/document.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0/bundled/config/document.vscode.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0.0/config/document.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0.0/bundled/config/document.json
      - https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0.0/bundled/config/document.vscode.json
      - https://aka.ms/dsc/schemas/v3/config/document.json
      - https://aka.ms/dsc/schemas/v3/bundled/config/document.json
      - https://aka.ms/dsc/schemas/v3/bundled/config/document.vscode.json
      - https://aka.ms/dsc/schemas/v3.0/config/document.json
      - https://aka.ms/dsc/schemas/v3.0/bundled/config/document.json
      - https://aka.ms/dsc/schemas/v3.0/bundled/config/document.vscode.json
      - https://aka.ms/dsc/schemas/v3.0.0/config/document.json
      - https://aka.ms/dsc/schemas/v3.0.0/bundled/config/document.json
      - https://aka.ms/dsc/schemas/v3.0.0/bundled/config/document.vscode.json
    # VS Code only:
    markdownDescription: |
      ***
      [_Online Documentation_][00]
      ***

      The `$schema` property indicates the URI that resolves to the version of this schema that the
      document adheres to. DSC uses this property when validating and processing the configuration
      document.

      The JSON schemas for DSC are published in multiple versions and forms. This documentation is
      for the latest version of the schema. As a convenience, you can specify either the full URI
      for the schema hosted in GitHub or use the shorter `aka.ms` URI. You can specify the schema
      for a specific semantic version, the latest schema for a minor version, or the latest schema
      for a major version of DSC. For more information about schema URIs and versioning, see
      [DSC JSON Schema URIs][01].

      For every version of the schema, there are three valid urls:

      ```yaml
      .../config/document.json
      ```
      
      > The URL to the canonical non-bundled schema. When it's used for validation, the validating
      > client needs to retrieve this schema and every schema it references.
        
      ```yaml
      .../bundled/config/document.json
      ```
      
      > The URL to the bundled schema. When it's used for validation, the validating client only
      > needs to retrieve this schema.
      >
      > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
      > still validate the document when it uses this schema, other tools may error or behave
      > in unexpected ways.

      ```yaml
      .../bundled/config/document.vscode.json
      ```
      
      > The URL to the enhanced authoring schema. This schema is much larger than the other
      > schemas, as it includes additional definitions that provide contextual help and snippets
      > that the others don't include.
      >
      > This schema uses keywords that are only recognized by VS Code. While DSC can still
      > validate the document when it uses this schema, other tools may error or behave in
      > unexpected ways.

      [00]: <DOCS_BASE_URL>/reference/schemas/config/document?<DOCS_VERSION_PIN>#schema
      [01]: <DOCS_BASE_URL>/reference/schemas/schema-uris?<DOCS_VERSION_PIN>
    markdownEnumDescriptions:
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3/config/document.json
          <!-- force a line break -->

          > #### `v3` non-bundled
          >
          > Indicates that the configuration document adheres to the `v3` schema. This URL
          > points to the canonical non-bundled schema. When it's used for validation, the
          > validating client needs to retrieve this schema and every schema it references.
          >
          > This URI is for the schemas in a major version folder. If you pin to a major version
          > folder, like `v3`, the schemas you use will update with every nonbreaking release. You
          > can use those schemas until you want or need to migrate to a new major version of DSC.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3/bundled/config/document.json
          <!-- force a line break -->

          > #### `v3` bundled
          >
          > Indicates that the configuration document adheres to the `v3` schema. This URL
          > points to the bundled schema. When it's used for validation, the validating client
          > only needs to retrieve this schema.
          >
          > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
          > still validate the document when it uses this schema, other tools may error or behave
          > in unexpected ways.
          >
          > This URI is for the schemas in a major version folder. If you pin to a major version
          > folder, like `v3`, the schemas you use will update with every nonbreaking release. You
          > can use those schemas until you want or need to migrate to a new major version of DSC.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3/bundled/config/document.vscode.json
          <!-- force a line break -->

          > #### `v3` enhanced authoring
          >
          > Indicates that the configuration document adheres to the `v3` schema. This URL
          > points to the enhanced authoring schema. This schema is much larger than the other
          > schemas, as it includes additional definitions that provide contextual help and
          > snippets that the others don't include.
          >
          > This schema uses keywords that are only recognized by VS Code. While DSC can still
          > validate the document when it uses this schema, other tools may error or behave in
          > unexpected ways.
          >
          > This URI is for the schemas in a major version folder. If you pin to a major version
          > folder, like `v3`, the schemas you use will update with every nonbreaking release. You
          > can use those schemas until you want or need to migrate to a new major version of DSC.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0` non-bundled, canonical URI
          >
          > Indicates that the configuration document adheres to the `v3.0` schema. This URL
          > points to the canonical non-bundled schema. When it's used for validation, the
          > validating client needs to retrieve this schema and every schema it references.
          >
          > This URI is for the schemas in a minor version folder. If you pin to a minor version
          > folder, like `v3.0`, the schemas you use will update with every patch release. Pinning
          > to a minor version folder enables you to take advantage of fixes to the schemas without
          > continually updating your schema URIs. However, to take advantage of any improvements
          > or new features, you need to update the URI whenever a new minor version is released.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0/bundled/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0` bundled, canonical URI
          >
          > Indicates that the configuration document adheres to the `v3.0` schema. This URL
          > points to the bundled schema. When it's used for validation, the validating client
          > only needs to retrieve this schema.
          >
          > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
          > still validate the document when it uses this schema, other tools may error or behave
          > in unexpected ways.
          >
          > This URI is for the schemas in a minor version folder. If you pin to a minor version
          > folder, like `v3.0`, the schemas you use will update with every patch release. Pinning
          > to a minor version folder enables you to take advantage of fixes to the schemas without
          > continually updating your schema URIs. However, to take advantage of any improvements
          > or new features, you need to update the URI whenever a new minor version is released.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0/bundled/config/document.vscode.yaml
          <!-- force a line break -->

          > #### `v3.0` enhanced authoring, canonical URI
          >
          > Indicates that the configuration document adheres to the `v3.0` schema. This URL points
          > to the enhanced authoring schema. This schema is much larger than the other schemas, as
          > it includes additional definitions that provide contextual help and snippets that the
          > others don't include.
          >
          > This schema uses keywords that are only recognized by VS Code. While DSC can still
          > validate the document when it uses this schema, other tools may error or behave in
          > unexpected ways.
          >
          > This URI is for the schemas in a minor version folder. If you pin to a minor version
          > folder, like `v3.0`, the schemas you use will update with every patch release. Pinning
          > to a minor version folder enables you to take advantage of fixes to the schemas without
          > continually updating your schema URIs. However, to take advantage of any improvements
          > or new features, you need to update the URI whenever a new minor version is released.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0.0/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0.0` non-bundled, canonical URI
          >
          > Indicates that the configuration document adheres to the `v3.0.0` schema. This URL
          > points to the canonical non-bundled schema. When it's used for validation, the
          > validating client needs to retrieve this schema and every schema it references.
          >
          > This URI is for the schemas in a full semantic version folder. If you pin to a full
          > semantic version folder, like `v3.0.0`, you're pinning to schemas that won't change.
          > However, to take advantage of any improvements or fixes to the schemas, you need to
          > update the URI with each release.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0.0/bundled/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0.0` bundled, canonical URI
          >
          > Indicates that the configuration document adheres to the `v3.0.0` schema. This URL
          > points to the bundled schema. When it's used for validation, the validating client
          > only needs to retrieve this schema.
          >
          > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
          > still validate the document when it uses this schema, other tools may error or behave
          > in unexpected ways.
          >
          > This URI is for the schemas in a full semantic version folder. If you pin to a full
          > semantic version folder, like `v3.0.0`, you're pinning to schemas that won't change.
          > However, to take advantage of any improvements or fixes to the schemas, you need to
          > update the URI with each release.
      - | # https://raw.githubusercontent.com/PowerShell/DSC/main/schemas/v3.0.0/bundled/config/document.vscode.yaml
          <!-- force a line break -->

          > #### `v3.0.0` enhanced authoring, canonical URI
          >
          > Indicates that the configuration document adheres to the `v3.0.0` schema. This URL
          > points to the enhanced authoring schema. This schema is much larger than the other
          > schemas, as it includes additional definitions that provide contextual help and
          > snippets that the others don't include.
          >
          > This schema uses keywords that are only recognized by VS Code. While DSC can still
          > validate the document when it uses this schema, other tools may error or behave in
          > unexpected ways.
          >
          > This URI is for the schemas in a full semantic version folder. If you pin to a full
          > semantic version folder, like `v3.0.0`, you're pinning to schemas that won't change.
          > However, to take advantage of any improvements or fixes to the schemas, you need to
          > update the URI with each release.
      - | # https://aka.ms/dsc/schemas/v3/config/document.yaml
          <!-- force a line break -->

          > #### `v3` non-bundled, short URI
          >
          > Indicates that the configuration document adheres to the `v3` schema. This URL
          > points to the canonical non-bundled schema. When it's used for validation, the
          > validating client needs to retrieve this schema and every schema it references.
          >
          > This URI is for the schemas in a major version folder. If you pin to a major version
          > folder, like `v3`, the schemas you use will update with every nonbreaking release. You
          > can use those schemas until you want or need to migrate to a new major version of DSC.
      - | # https://aka.ms/dsc/schemas/v3/bundled/config/document.yaml
          <!-- force a line break -->

          > #### `v3` bundled, short URI
          >
          > Indicates that the configuration document adheres to the `v3` schema. This URL
          > points to the bundled schema. When it's used for validation, the validating client
          > only needs to retrieve this schema.
          >
          > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
          > still validate the document when it uses this schema, other tools may error or behave
          > in unexpected ways.
          >
          > This URI is for the schemas in a major version folder. If you pin to a major version
          > folder, like `v3`, the schemas you use will update with every nonbreaking release. You
          > can use those schemas until you want or need to migrate to a new major version of DSC.
      - | # https://aka.ms/dsc/schemas/v3/bundled/config/document.vscode.yaml
          <!-- force a line break -->

          > #### `v3` enhanced authoring, short URI
          >
          > Indicates that the configuration document adheres to the `v3` schema. This URL points
          > to the enhanced authoring schema. This schema is much larger than the other schemas, as
          > it includes additional definitions that provide contextual help and snippets that the
          > others don't include.
          >
          > This schema uses keywords that are only recognized by VS Code. While DSC can still
          > validate the document when it uses this schema, other tools may error or behave in
          > unexpected ways.
          >
          > This URI is for the schemas in a major version folder. If you pin to a major version
          > folder, like `v3`, the schemas you use will update with every nonbreaking release. You
          > can use those schemas until you want or need to migrate to a new major version of DSC.
      - | # https://aka.ms/dsc/schemas/v3.0/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0` non-bundled, short URI
          >
          > Indicates that the configuration document adheres to the `v3.0` schema. This URL
          > points to the canonical non-bundled schema. When it's used for validation, the
          > validating client needs to retrieve this schema and every schema it references.
          >
          > This URI is for the schemas in a minor version folder. If you pin to a minor version
          > folder, like `v3.0`, the schemas you use will update with every patch release. Pinning
          > to a minor version folder enables you to take advantage of fixes to the schemas without
          > continually updating your schema URIs. However, to take advantage of any improvements
          > or new features, you need to update the URI whenever a new minor version is released.
      - | # https://aka.ms/dsc/schemas/v3.0/bundled/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0` bundled, short URI
          >
          > Indicates that the configuration document adheres to the `v3.0` schema. This URL
          > points to the bundled schema. When it's used for validation, the validating client
          > only needs to retrieve this schema.
          >
          > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
          > still validate the document when it uses this schema, other tools may error or behave
          > in unexpected ways.
          >
          > This URI is for the schemas in a minor version folder. If you pin to a minor version
          > folder, like `v3.0`, the schemas you use will update with every patch release. Pinning
          > to a minor version folder enables you to take advantage of fixes to the schemas without
          > continually updating your schema URIs. However, to take advantage of any improvements
          > or new features, you need to update the URI whenever a new minor version is released.
      - | # https://aka.ms/dsc/schemas/v3.0/bundled/config/document.vscode.yaml
          <!-- force a line break -->

          > #### `v3.0` enhanced authoring, short URI
          >
          > Indicates that the configuration document adheres to the `v3.0` schema. This URL points
          > to the enhanced authoring schema. This schema is much larger than the other schemas, as
          > it includes additional definitions that provide contextual help and snippets that the
          > others don't include.
          >
          > This schema uses keywords that are only recognized by VS Code. While DSC can still
          > validate the document when it uses this schema, other tools may error or behave in
          > unexpected ways.
          >
          > This URI is for the schemas in a minor version folder. If you pin to a minor version
          > folder, like `v3.0`, the schemas you use will update with every patch release. Pinning
          > to a minor version folder enables you to take advantage of fixes to the schemas without
          > continually updating your schema URIs. However, to take advantage of any improvements
          > or new features, you need to update the URI whenever a new minor version is released.
      - | # https://aka.ms/dsc/schemas/v3.0.0/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0.0` non-bundled, short URI
          >
          > Indicates that the configuration document adheres to the `v3.0.0` schema. This URL
          > points to the canonical non-bundled schema. When it's used for validation, the
          > validating client needs to retrieve this schema and every schema it references.
          >
          > This URI is for the schemas in a full semantic version folder. If you pin to a full
          > semantic version folder, like `v3.0.0`, you're pinning to schemas that won't change.
          > However, to take advantage of any improvements or fixes to the schemas, you need to
          > update the URI with each release.
      - | # https://aka.ms/dsc/schemas/v3.0.0/bundled/config/document.yaml
          <!-- force a line break -->

          > #### `v3.0.0` bundled, short URI
          >
          > Indicates that the configuration document adheres to the `v3.0.0` schema. This URL
          > points to the bundled schema. When it's used for validation, the validating client
          > only needs to retrieve this schema.
          >
          > This schema uses the bundling model introduced for JSON Schema 2020-12. While DSC can
          > still validate the document when it uses this schema, other tools may error or behave
          > in unexpected ways.
          >
          > This URI is for the schemas in a full semantic version folder. If you pin to a full
          > semantic version folder, like `v3.0.0`, you're pinning to schemas that won't change.
          > However, to take advantage of any improvements or fixes to the schemas, you need to
          > update the URI with each release.
      - | # https://aka.ms/dsc/schemas/v3.0.0/bundled/config/document.vscode.yaml
          <!-- force a line break -->

          > #### `v3.0.0` enhanced authoring, short URI
          >
          > Indicates that the configuration document adheres to the `v3.0.0` schema. This URL
          > points to the enhanced authoring schema. This schema is much larger than the other
          > schemas, as it includes additional definitions that provide contextual help and
          > snippets that the others don't include.
          >
          > This schema uses keywords that are only recognized by VS Code. While DSC can still
          > validate the document when it uses this schema, other tools may error or behave in
          > unexpected ways.
          >
          > This URI is for the schemas in a full semantic version folder. If you pin to a full
          > semantic version folder, like `v3.0.0`, you're pinning to schemas that won't change.
          > However, to take advantage of any improvements or fixes to the schemas, you need to
          > update the URI with each release.
  parameters:
    title: DSC configuration document parameters
    description: >-
      Defines runtime options for the configuration. Users and integrating tools can override use
      the defined parameters to pass alternate values to the configuration.
    type: object
    additionalProperties:
      $ref: /<PREFIX>/<VERSION>/config/document.parameter.yaml
    # VS Code only
    markdownDescription: |
      ***
      [_Online Documentation_][01]
      ***

      Defines runtime options for the configuration. Users and integrating tools can override use
      the defined parameters to pass alternate values to the configuration.

      [01]: <DOCS_BASE_URL>/reference/schemas/config/document?<DOCS_VERSION_PIN>#parameters
    defaultSnippets:
      - label: ' New Parameter'
        markdownDescription: |-
          Defines a new runtime option for the configuration.

          ```yaml
          parameterId:
            type:          <type>
            description:   <description text>
            defaultValue:  <value>
            allowedValues:
              - <first>
          ```
        body:
          ${1:parameterId}:
            type:          $2
            description:   $3
            defaultValue:  $4
            allowedValues:
              - $5

      - label: ' New Integer Parameter'
        markdownDescription: |-
          Defines a new runtime option for the configuration as an integer value.

          ```yaml
          parameterId:
            type:          int
            description:   <description text>
            defaultValue:  <value>
            minValue:      <minimum>
            minValue:      <maximum>
          ```
        body:
          ${1:parameterId}:
            type:         int
            description:  $2
            defaultValue: $3
            minValue:     $4
            maxValue:     $5

  variables:
    title: Configuration variables
    description: >-
      Defines a set of reusable values for the configuration document. The names of this value's
      properties are the strings used to reference a variable's value.
    type: object
    # VS Code only
    markdownDescription: |
      ***
      [_Online Documentation_][01]
      ***

      Defines a set of reusable values for the configuration document. The names of this value's
      properties are the strings used to reference a variable's value.

      [01]: <DOCS_BASE_URL>/reference/schemas/config/document?<DOCS_VERSION_PIN>#variables
    defaultSnippets:
      - label: ' New variable property'
        markdownDescription: |-
          Defines a new variable as a key-value pair.

          ```yaml
          variableName: variableValue
          ```
        body:
          ${1:variableName}: ${2:variableValue}

      - label: ' New variable property (object)'
        markdownDescription: |-
          Defines a new key-value pair for the variables where the value is an object.

          ```yaml
          variableName:
            key: value
          ```
        body:
          ${1:variableName}:
            ${2:key}: ${3:value}

      - label: ' New variable property (array)'
        markdownDescription: |-
          Defines a new key-value pair for the variables where the value is an array.

          ```yaml
          variableName:
            - firstValue
            - secondValue
          ```
        body:
          ${1:variableName}:
            - ${2:firstValue}
            - ${3:secondValue}

  resources:
    title:       DSC configuration document resources
    description: Defines a list of DSC resource instances for the configuration to manage.
    type:        array
    minItems:    0
    items:
      $ref: /<PREFIX>/<VERSION>/config/document.resource.yaml
    # VS Code only
    markdownDescription: |
      ***
      [_Online Documentation_][01]
      ***

      Defines a list of DSC resource instances for the configuration to manage.

      [01]: <DOCS_BASE_URL>/reference/schemas/config/document?<DOCS_VERSION_PIN>#resources

  metadata:
    $ref: /<PREFIX>/<VERSION>/config/document.metadata.yaml
